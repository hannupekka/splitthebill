(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var Reflux=require("reflux"),PersonActions=Reflux.createActions(["addPerson","editPerson","deletePerson","shareTotal","setPersons","reset"]);module.exports=PersonActions;

},{"reflux":31}],2:[function(require,module,exports){
var Reflux=require("reflux"),SettingActions=Reflux.createActions(["toggleVisibility","setCurrency","setBid","reset"]);module.exports=SettingActions;

},{"reflux":31}],3:[function(require,module,exports){
var Reflux=require("reflux"),ValidateActions=Reflux.createActions([]);module.exports=ValidateActions;

},{"reflux":31}],4:[function(require,module,exports){
var React=require("react"),Router=require("react-router"),Route=Router.Route,PaymentWrapper=require("./components/paymentwrapper.jsx"),routes=React.createElement(Route,{handler:PaymentWrapper},React.createElement(Route,{name:"index",path:"/",handler:PaymentWrapper}),React.createElement(Route,{name:"bill",path:"/:bid",handler:PaymentWrapper}));Router.run(routes,function(e){React.render(React.createElement(e,null),document.getElementById("wrapper"))});

},{"./components/paymentwrapper.jsx":7,"react":"react","react-router":"react-router"}],5:[function(require,module,exports){
var React=require("react"),ReactIntl=require("react-intl"),IntlMixin=ReactIntl.IntlMixin,FormattedNumber=ReactIntl.FormattedNumber;module.exports=React.createClass({displayName:"exports",mixins:[IntlMixin],render:function(){return React.createElement("div",{className:"paymentList__transaction clearfix"},React.createElement("div",{className:"transaction__amount"},React.createElement(FormattedNumber,{value:this.props.amount,style:"currency",currency:"EUR"}),React.createElement("i",{className:"fa fa-long-arrow-right"}),this.props.to))}});

},{"react":"react","react-intl":"react-intl"}],6:[function(require,module,exports){
var React=require("react"),Reflux=require("reflux"),Payment=require("./payment.jsx"),ReactIntl=require("react-intl"),IntlMixin=ReactIntl.IntlMixin,FormattedNumber=ReactIntl.FormattedNumber,PersonStore=require("../stores/personstore.js"),SettingStore=require("../stores/settingstore.js"),map=require("lodash.map");module.exports=React.createClass({displayName:"exports",mixins:[IntlMixin,Reflux.connect(PersonStore,"persons"),Reflux.connect(SettingStore,"settings")],render:function(){var e=map(this.state.persons.payments,function(e,t){var a=e.to.map(function(e,t){return React.createElement(Payment,{key:t,to:e.to,amount:e.amount})});return React.createElement("div",{key:t,className:"paymentList__payment clearfix col-md-4"},React.createElement("div",{className:"paymentList__from"},e.name," pays:"),React.createElement("div",{className:"paymentList__transactions clearfix bg-primary"},a))}),t=Object.keys(this.state.persons.payments).length>0?"clearfix":"hidden";return React.createElement("div",{id:"paymentList",className:t},React.createElement("div",{className:"stats col-xs-12"},React.createElement("b",null,"Total: ")," ",React.createElement(FormattedNumber,{value:this.state.persons.total,style:"currency",currency:this.state.settings.currency})," ",React.createElement("br",null),React.createElement("b",null,"Share: ")," ",React.createElement(FormattedNumber,{value:this.state.persons.share,style:"currency",currency:this.state.settings.currency})," ",React.createElement("br",null)),e)}});

},{"../stores/personstore.js":12,"../stores/settingstore.js":13,"./payment.jsx":5,"lodash.map":"lodash.map","react":"react","react-intl":"react-intl","reflux":31}],7:[function(require,module,exports){
var React=require("react"),Reflux=require("reflux"),PersonList=require("./personlist.jsx"),PaymentList=require("./paymentlist.jsx"),Settings=require("./settings.jsx"),Router=require("react-router"),PersonActions=require("../actions/personactions.js"),SettingActions=require("../actions/settingactions.js"),PersonStore=require("../stores/personstore.js"),ValidateStore=require("../stores/validatestore.js"),SettingStore=require("../stores/settingstore.js"),request=require("browser-request"),shareBill=require("../functions.js");module.exports=React.createClass({displayName:"exports",mixins:[Reflux.connect(PersonStore,"persons"),Reflux.connect(ValidateStore,"validation"),Reflux.connect(SettingStore,"settings")],contextTypes:{router:React.PropTypes.func},componentDidMount:function(){window.addEventListener("keydown",this.handleKeyDown);var e=window.location.origin,t=this.context.router.getCurrentParams().bid;t&&request(e+"/api/v1/bill/"+t,function(e,t,n){if(200!==t.statusCode)this.context.router.transitionTo("index");else{var s=JSON.parse(n),a=shareBill(this.getData(s.data));PersonActions.setPersons(s.data),SettingActions.setCurrency(s.currency),PersonActions.shareTotal(a)}}.bind(this))},componentWillUnmount:function(){window.removeEventListener("keydown",this.handleKeyDown)},addPerson:function(e){e&&e.preventDefault(),PersonActions.addPerson()},toggleSettings:function(e){e&&e.preventDefault(),SettingActions.toggleVisibility()},shareTotal:function(e){if(e&&e.preventDefault(),this.state.validation.valid){var t=shareBill(this.getData(this.state.persons.personList));PersonActions.shareTotal(t)}},saveBill:function(e){if(e&&e.preventDefault(),this.state.validation.valid&&0!==Object.keys(this.state.persons.payments).length){var t=window.location.origin,n=this.context.router,s=n.getCurrentParams().bid,a=s?"PUT":"POST",i=s?"/bill/"+s:"/bill";request({url:t+"/api/v1"+i,method:a,body:{data:this.state.persons.personList,currency:this.state.settings.currency},json:!0},function(e,t,a){s||(SettingActions.setBid(a.bid),n.transitionTo("bill",{bid:a.bid}))}.bind(this))}},deleteBill:function(e){e&&e.preventDefault();var t=window.location.origin,n=this.context.router,s=n.getCurrentParams().bid;request({url:t+"/api/v1/bill/"+s,method:"DELETE"},function(e,t,s){PersonActions.reset(),SettingActions.reset(),n.transitionTo("index")}.bind(this))},getData:function(e){for(var t,n,s=[],a=0,i=e.length;i>a;a++)t=e[a],n="string"==typeof t.paid?t.paid.split(" ").reduce(function(e,t){return Number(e)+Number(t.replace(",","."))},0):t.paid,s.push({name:t.name,paid:Number(n)});return s},handleKeyDown:function(e){if(e.ctrlKey||e.metaKey)switch(String.fromCharCode(e.which).toLowerCase()){case"s":e.preventDefault(),this.saveBill()}else 13===e.keyCode&&(e.preventDefault(),this.shareTotal())},render:function(){var e=this.state.validation.valid?void 0:"disabled",t=function(){return Object.keys(this.state.persons.payments).length>0?React.createElement("button",{className:"btn btn-sm btn-primary",onClick:this.saveBill,disabled:e},React.createElement("i",{className:"fa fa-floppy-o"}),React.createElement("span",{className:"hidden-xs"}," Save bill")):void 0}.bind(this),n=function(){var e=this.context.router.getCurrentParams().bid;return e?React.createElement("button",{className:"btn btn-sm btn-primary",onClick:this.deleteBill},React.createElement("i",{className:"fa fa-trash-o"}),React.createElement("span",{className:"hidden-xs"}," Delete bill")):void 0}.bind(this);return React.createElement("div",null,React.createElement(Settings,null),React.createElement(PersonList,null),React.createElement("div",{className:"buttons main"},React.createElement("button",{className:"btn btn-sm btn-primary",onClick:this.addPerson},React.createElement("i",{className:"fa fa-user-plus"}),React.createElement("span",{className:"hidden-xs"}," Add person")),React.createElement("button",{className:"btn btn-sm btn-primary settings",onClick:this.toggleSettings},React.createElement("i",{className:"fa fa-cog"}),React.createElement("span",{className:"hidden-xs"}," Settings")),React.createElement("button",{className:"btn btn-sm btn-primary",onClick:this.shareTotal,disabled:e},React.createElement("i",{className:"fa fa-calculator"}),React.createElement("span",{className:"hidden-xs"}," Share total"))),React.createElement(PaymentList,null),React.createElement("div",{className:"col-xs-12 buttons"},t(),n()))}});

},{"../actions/personactions.js":1,"../actions/settingactions.js":2,"../functions.js":11,"../stores/personstore.js":12,"../stores/settingstore.js":13,"../stores/validatestore.js":14,"./paymentlist.jsx":6,"./personlist.jsx":9,"./settings.jsx":10,"browser-request":"browser-request","react":"react","react-router":"react-router","reflux":31}],8:[function(require,module,exports){
var React=require("react"),Reflux=require("reflux"),PersonActions=require("../actions/personactions.js"),ValidateActions=require("../actions/validateactions.js"),PersonStore=require("../stores/personstore.js"),ValidateStore=require("../stores/validatestore.js"),SettingStore=require("../stores/settingstore.js"),classNames=require("classnames");module.exports=React.createClass({displayName:"exports",mixins:[Reflux.connect(PersonStore,"persons"),Reflux.connect(ValidateStore,"validation"),Reflux.connect(SettingStore,"settings")],handleChange:function(e,t){PersonActions.editPerson(e,t.target.value,this.props.idx)},handleDelete:function(e){e&&e.preventDefault(),PersonActions.deletePerson(this.props.idx,e)},setName:function(){return this.props.person.name},setPaid:function(){return this.props.person.paid},keyDown:function(e){9===e.which&&PersonActions.addPerson()},render:function(){var e=function(){return this.state.persons.personList&&this.state.persons.personList.length>1?React.createElement("div",{className:"col-xs-1"},React.createElement("button",{className:"btn btn-primary btn-sm btn-remove",onClick:this.handleDelete,tabIndex:"-1"},React.createElement("i",{className:"fa fa-minus"}))):void 0}.bind(this),t=classNames({person__name:!0,"col-xs-4":!0,"has-error":this.state.validation.persons[this.props.idx]&&!this.state.validation.persons[this.props.idx].name}),s=classNames({"input-group":!0,"has-error":this.state.validation.persons[this.props.idx]&&!this.state.validation.persons[this.props.idx].paid});return React.createElement("div",{className:"personList__person clearfix"},React.createElement("div",{className:t},React.createElement("input",{type:"text",className:"form-control input-lg",placeholder:"John Doe",value:this.setName(),onChange:this.handleChange.bind(this,"name"),autoFocus:!0})),React.createElement("div",{className:"person__paid col-xs-6"},React.createElement("div",{className:s},React.createElement("input",{type:"tel",className:"form-control input-lg",placeholder:"0",value:this.setPaid(),onChange:this.handleChange.bind(this,"paid"),onKeyDown:this.keyDown}),React.createElement("div",{className:"input-group-addon"},this.state.settings.currency))),e())}});

},{"../actions/personactions.js":1,"../actions/validateactions.js":3,"../stores/personstore.js":12,"../stores/settingstore.js":13,"../stores/validatestore.js":14,"classnames":"classnames","react":"react","reflux":31}],9:[function(require,module,exports){
var React=require("react/addons"),Reflux=require("reflux"),Person=require("./person.jsx"),PersonStore=require("../stores/personstore.js"),request=require("browser-request");module.exports=React.createClass({displayName:"exports",mixins:[Reflux.connect(PersonStore,"persons")],render:function(){var e="";return this.state.persons.personList&&(e=this.state.persons.personList.map(function(e,r){return React.createElement(Person,{key:r,idx:r,person:e})}.bind(this))),React.createElement("form",{id:"personList"},e,React.createElement("div",{id:"help"},"Protip: you can enter multiple amounts for person by separating them by space!"))}});

},{"../stores/personstore.js":12,"./person.jsx":8,"browser-request":"browser-request","react/addons":"react/addons","reflux":31}],10:[function(require,module,exports){
var React=require("react"),Reflux=require("reflux"),SettingActions=require("../actions/settingactions.js"),SettingStore=require("../stores/settingstore.js"),classNames=require("classnames");module.exports=React.createClass({displayName:"exports",mixins:[Reflux.connect(SettingStore,"settings")],setCurrency:function(e){SettingActions.setCurrency(e.target.value)},render:function(){var e=classNames({"form-horizontal":!0,"col-xs-12":!0,hidden:!this.state.settings.visible});return React.createElement("form",{id:"settings",className:e},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"currency"},"Currency"),React.createElement("select",{id:"currency",className:"form-control input-lg",onChange:this.setCurrency},React.createElement("option",{value:"EUR"},"EUR"),React.createElement("option",{value:"USD"},"USD"))))}});

},{"../actions/settingactions.js":2,"../stores/settingstore.js":13,"classnames":"classnames","react":"react","reflux":31}],11:[function(require,module,exports){
var sortBy=require("lodash.sortby"),each=require("lodash.foreach"),reduce=require("lodash.reduce"),find=require("lodash.find"),remove=require("lodash.remove");module.exports=function(e){var r,t,a,n;return remove(e,function(e){return!e.name||0===e.name.length}),r=sortBy(e,"paid").reverse(),each(r,function(e,r){e.id=r,e.paid=Math.round(Number(100*e.paid))}),t=reduce(r,function(e,r){return e+r.paid},0),a=r.length>0?Math.round(Number(t/r.length)):0,n={},each(r,function(e){e.left=Math.round(a-e.paid);for(var t;e.left>0;)if(n[e.id]=n[e.id]||{name:e.name,to:[]},t=find(r,function(e){return e.left<0})){var o=Math.abs(t.left)>e.left?e.left:Math.abs(t.left);t.left+=o,e.left-=o,n[e.id].to.push({to:t.name,amount:Number(o/100)})}else e.left=0}),{payments:n,total:Number(t/100),share:Number(a/100)}};

},{"lodash.find":"lodash.find","lodash.foreach":"lodash.foreach","lodash.reduce":"lodash.reduce","lodash.remove":"lodash.remove","lodash.sortby":"lodash.sortby"}],12:[function(require,module,exports){
var Reflux=require("reflux"),PersonActions=require("../actions/personactions.js"),Data=function(){return{personList:[],payments:{},total:0,share:0}},PersonStore=Reflux.createStore({listenables:[PersonActions],persons:new Data,init:function(){this.addPerson()},getInitialState:function(){return this.persons},addPerson:function(){this.persons.personList.push({name:void 0,paid:void 0}),this.trigger(this.persons)},editPerson:function(s,e,t){this.persons.personList[t][s]=e,this.persons.personList[t].pristine&&delete this.persons.personList[t].pristine,this.trigger(this.persons)},deletePerson:function(s){this.persons.personList.splice(s,1),this.trigger(this.persons)},shareTotal:function(s){this.persons.payments=s.payments,this.persons.total=s.total,this.persons.share=s.share,this.trigger(this.persons)},setPersons:function(s){this.persons.personList=s,this.trigger(this.persons)},reset:function(){this.persons=new Data,this.addPerson(),this.trigger(this.persons)}});module.exports=PersonStore;

},{"../actions/personactions.js":1,"reflux":31}],13:[function(require,module,exports){
var Reflux=require("reflux"),SettingActions=require("../actions/settingactions.js"),Settings=function(){return{visible:!1,currency:"EUR",bid:void 0}},SettingStore=Reflux.createStore({listenables:[SettingActions],settings:new Settings,getInitialState:function(){return this.settings},toggleVisibility:function(){this.settings.visible=!this.settings.visible,this.trigger(this.settings)},setCurrency:function(t){this.settings.currency=t,this.trigger(this.settings)},setBid:function(t){this.settings.bid=t,this.trigger(this.settings)},reset:function(){this.settings=new Settings,this.trigger(this.settings)}});module.exports=SettingStore;

},{"../actions/settingactions.js":2,"reflux":31}],14:[function(require,module,exports){
var Reflux=require("reflux"),ValidateActions=require("../actions/validateactions.js"),PersonStore=require("./personstore.js"),ValidateStore=Reflux.createStore({listenables:[ValidateActions],results:{persons:[],valid:!1},init:function(){this.listenTo(PersonStore,this.validateForm,this.validateInitialForm)},getInitialState:function(){return this.results},validateInitialForm:function(e){this.results.persons=this.parsePersons(e,!0),this.trigger(this.results)},validateForm:function(e){this.results.persons=this.parsePersons(e,!1),this.results.valid=this.results.persons.every(function(e){return e.name===!0&&e.paid===!0}),this.trigger(this.results)},parsePersons:function(e,t){return e.personList.map(function(e,s){var i=t,r=t;return i="undefined"!=typeof e.name?e.name.length>0:"pristine",r="undefined"!=typeof e.paid?null!==e.paid.match(/^[\d,. ]+$/):"pristine",{name:i,paid:r}})}});module.exports=ValidateStore;

},{"../actions/validateactions.js":3,"./personstore.js":12,"reflux":31}],15:[function(require,module,exports){
"use strict";function EE(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function EventEmitter(){}var prefix="function"!=typeof Object.create?"~":!1;EventEmitter.prototype._events=void 0,EventEmitter.prototype.listeners=function(e,t){var n=prefix?prefix+e:e,r=this._events&&this._events[n];if(t)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,o=new Array(s);s>i;i++)o[i]=r[i].fn;return o},EventEmitter.prototype.emit=function(e,t,n,r,i,s){var o=prefix?prefix+e:e;if(!this._events||!this._events[o])return!1;var f,v,c=this._events[o],h=arguments.length;if("function"==typeof c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,r),!0;case 5:return c.fn.call(c.context,t,n,r,i),!0;case 6:return c.fn.call(c.context,t,n,r,i,s),!0}for(v=1,f=new Array(h-1);h>v;v++)f[v-1]=arguments[v];c.fn.apply(c.context,f)}else{var p,a=c.length;for(v=0;a>v;v++)switch(c[v].once&&this.removeListener(e,c[v].fn,void 0,!0),h){case 1:c[v].fn.call(c[v].context);break;case 2:c[v].fn.call(c[v].context,t);break;case 3:c[v].fn.call(c[v].context,t,n);break;default:if(!f)for(p=1,f=new Array(h-1);h>p;p++)f[p-1]=arguments[p];c[v].fn.apply(c[v].context,f)}}return!0},EventEmitter.prototype.on=function(e,t,n){var r=new EE(t,n||this),i=prefix?prefix+e:e;return this._events||(this._events=prefix?{}:Object.create(null)),this._events[i]?this._events[i].fn?this._events[i]=[this._events[i],r]:this._events[i].push(r):this._events[i]=r,this},EventEmitter.prototype.once=function(e,t,n){var r=new EE(t,n||this,!0),i=prefix?prefix+e:e;return this._events||(this._events=prefix?{}:Object.create(null)),this._events[i]?this._events[i].fn?this._events[i]=[this._events[i],r]:this._events[i].push(r):this._events[i]=r,this},EventEmitter.prototype.removeListener=function(e,t,n,r){var i=prefix?prefix+e:e;if(!this._events||!this._events[i])return this;var s=this._events[i],o=[];if(t)if(s.fn)(s.fn!==t||r&&!s.once||n&&s.context!==n)&&o.push(s);else for(var f=0,v=s.length;v>f;f++)(s[f].fn!==t||r&&!s[f].once||n&&s[f].context!==n)&&o.push(s[f]);return o.length?this._events[i]=1===o.length?o[0]:o:delete this._events[i],this},EventEmitter.prototype.removeAllListeners=function(e){return this._events?(e?delete this._events[prefix?prefix+e:e]:this._events=prefix?{}:Object.create(null),this):this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prototype.setMaxListeners=function(){return this},EventEmitter.prefixed=prefix,"undefined"!=typeof module&&(module.exports=EventEmitter);

},{}],16:[function(require,module,exports){
"use strict";module.exports={};

},{}],17:[function(require,module,exports){
"use strict";exports.createdStores=[],exports.createdActions=[],exports.reset=function(){for(;exports.createdStores.length;)exports.createdStores.pop();for(;exports.createdActions.length;)exports.createdActions.pop()};

},{}],18:[function(require,module,exports){
"use strict";var _=require("./utils"),maker=require("./joins").instanceJoinCreator,mapChildListenables=function(t){for(var i,n=0,s={};n<(t.children||[]).length;++n)i=t.children[n],t[i]&&(s[i]=t[i]);return s},flattenListenables=function t(i){var n={};for(var s in i){var e=i[s],r=mapChildListenables(e),a=t(r);n[s]=e;for(var o in a){var l=a[o];n[s+_.capitalize(o)]=l}}return n};module.exports={hasListener:function(t){for(var i,n,s,e=0;e<(this.subscriptions||[]).length;++e)for(s=[].concat(this.subscriptions[e].listenable),i=0;i<s.length;i++)if(n=s[i],n===t||n.hasListener&&n.hasListener(t))return!0;return!1},listenToMany:function(t){var i=flattenListenables(t);for(var n in i){var s=_.callbackName(n),e=this[s]?s:this[n]?n:void 0;e&&this.listenTo(i[n],e,this[s+"Default"]||this[e+"Default"]||e)}},validateListening:function(t){return t===this?"Listener is not able to listen to itself":_.isFunction(t.listen)?t.hasListener&&t.hasListener(this)?"Listener cannot listen to this listenable because of circular loop":void 0:t+" is missing a listen method"},listenTo:function(t,i,n){var s,e,r,a=this.subscriptions=this.subscriptions||[];return _.throwIf(this.validateListening(t)),this.fetchInitialState(t,n),s=t.listen(this[i]||i,this),e=function(){var t=a.indexOf(r);_.throwIf(-1===t,"Tried to remove listen already gone from subscriptions list!"),a.splice(t,1),s()},r={stop:e,listenable:t},a.push(r),r},stopListeningTo:function(t){for(var i,n=0,s=this.subscriptions||[];n<s.length;n++)if(i=s[n],i.listenable===t)return i.stop(),_.throwIf(-1!==s.indexOf(i),"Failed to remove listen from subscriptions list!"),!0;return!1},stopListeningToAll:function(){for(var t,i=this.subscriptions||[];t=i.length;)i[0].stop(),_.throwIf(i.length!==t-1,"Failed to remove listen from subscriptions list!")},fetchInitialState:function(t,i){i=i&&this[i]||i;var n=this;if(_.isFunction(i)&&_.isFunction(t.getInitialState)){var s=t.getInitialState();s&&_.isFunction(s.then)?s.then(function(){i.apply(n,arguments)}):i.call(this,s)}},joinTrailing:maker("last"),joinLeading:maker("first"),joinConcat:maker("all"),joinStrict:maker("strict")};

},{"./joins":25,"./utils":27}],19:[function(require,module,exports){
"use strict";var _=require("./utils");module.exports={preEmit:function(){},shouldEmit:function(){return!0},listen:function(i,t){t=t||this;var e=function(e){n||i.apply(t,e)},r=this,n=!1;return this.emitter.addListener(this.eventLabel,e),function(){n=!0,r.emitter.removeListener(r.eventLabel,e)}},promise:function(i){var t=this,e=this.children.indexOf("completed")>=0&&this.children.indexOf("failed")>=0;if(!e)throw new Error('Publisher must have "completed" and "failed" child publishers');i.then(function(i){return t.completed(i)},function(i){return t.failed(i)})},listenAndPromise:function(i,t){var e=this;t=t||this,this.willCallPromise=(this.willCallPromise||0)+1;var r=this.listen(function(){if(!i)throw new Error("Expected a function returning a promise but got "+i);var r=arguments,n=i.apply(t,r);return e.promise.call(e,n)},t);return function(){e.willCallPromise--,r.call(e)}},trigger:function(){var i=arguments,t=this.preEmit.apply(this,i);i=void 0===t?i:_.isArguments(t)?t:[].concat(t),this.shouldEmit.apply(this,i)&&this.emitter.emit(this.eventLabel,i)},triggerAsync:function(){var i=arguments,t=this;_.nextTick(function(){t.trigger.apply(t,i)})},triggerPromise:function(){var i=this,t=arguments,e=this.children.indexOf("completed")>=0&&this.children.indexOf("failed")>=0,r=_.createPromise(function(r,n){if(i.willCallPromise)return void _.nextTick(function(){var e=i.promise;i.promise=function(t){return t.then(r,n),i.promise=e,i.promise.apply(i,arguments)},i.trigger.apply(i,t)});if(e)var s=i.completed.listen(function(i){s(),l(),r(i)}),l=i.failed.listen(function(i){s(),l(),n(i)});i.triggerAsync.apply(i,t),e||r()});return r}};

},{"./utils":27}],20:[function(require,module,exports){
"use strict";module.exports={};

},{}],21:[function(require,module,exports){
"use strict";module.exports=function(e,t){for(var r in t)if(Object.getOwnPropertyDescriptor&&Object.defineProperty){var n=Object.getOwnPropertyDescriptor(t,r);if(!n.value||"function"!=typeof n.value||!t.hasOwnProperty(r))continue;e[r]=t[r].bind(e)}else{var o=t[r];if("function"!=typeof o||!t.hasOwnProperty(r))continue;e[r]=o.bind(e)}return e};

},{}],22:[function(require,module,exports){
"use strict";var _=require("./utils"),ActionMethods=require("./ActionMethods"),PublisherMethods=require("./PublisherMethods"),Keep=require("./Keep"),allowed={preEmit:1,shouldEmit:1},createAction=function e(r){r=r||{},_.isObject(r)||(r={actionName:r});for(var t in ActionMethods)if(!allowed[t]&&PublisherMethods[t])throw new Error("Cannot override API method "+t+" in Reflux.ActionMethods. Use another method name or override it on Reflux.PublisherMethods instead.");for(var i in r)if(!allowed[i]&&PublisherMethods[i])throw new Error("Cannot override API method "+i+" in action creation. Use another method name or override it on Reflux.PublisherMethods instead.");r.children=r.children||[],r.asyncResult&&(r.children=r.children.concat(["completed","failed"]));for(var o=0,n={};o<r.children.length;o++){var s=r.children[o];n[s]=e(s)}var d=_.extend({eventLabel:"action",emitter:new _.EventEmitter,_isAction:!0},PublisherMethods,ActionMethods,r),h=function a(){var e=a.sync?"trigger":_.environment.hasPromise?"triggerPromise":"triggerAsync";return a[e].apply(a,arguments)};return _.extend(h,n,d),Keep.createdActions.push(h),h};module.exports=createAction;

},{"./ActionMethods":16,"./Keep":17,"./PublisherMethods":19,"./utils":27}],23:[function(require,module,exports){
"use strict";var _=require("./utils"),Keep=require("./Keep"),mixer=require("./mixer"),bindMethods=require("./bindMethods"),allowed={preEmit:1,shouldEmit:1};module.exports=function(e){function t(){var t,r=0;if(this.subscriptions=[],this.emitter=new _.EventEmitter,this.eventLabel="change",bindMethods(this,e),this.init&&_.isFunction(this.init)&&this.init(),this.listenables)for(t=[].concat(this.listenables);r<t.length;r++)this.listenToMany(t[r])}var r=require("./StoreMethods"),i=require("./PublisherMethods"),o=require("./ListenerMethods");e=e||{};for(var n in r)if(!allowed[n]&&(i[n]||o[n]))throw new Error("Cannot override API method "+n+" in Reflux.StoreMethods. Use another method name or override it on Reflux.PublisherMethods / Reflux.ListenerMethods instead.");for(var s in e)if(!allowed[s]&&(i[s]||o[s]))throw new Error("Cannot override API method "+s+" in store creation. Use another method name or override it on Reflux.PublisherMethods / Reflux.ListenerMethods instead.");e=mixer(e),_.extend(t.prototype,o,i,r,e);var h=new t;return Keep.createdStores.push(h),h};

},{"./Keep":17,"./ListenerMethods":18,"./PublisherMethods":19,"./StoreMethods":20,"./bindMethods":21,"./mixer":26,"./utils":27}],24:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Reflux={version:{"reflux-core":"0.2.1"}};Reflux.ActionMethods=require("./ActionMethods"),Reflux.ListenerMethods=require("./ListenerMethods"),Reflux.PublisherMethods=require("./PublisherMethods"),Reflux.StoreMethods=require("./StoreMethods"),Reflux.createAction=require("./createAction"),Reflux.createStore=require("./createStore");var maker=require("./joins").staticJoinCreator;Reflux.joinTrailing=Reflux.all=maker("last"),Reflux.joinLeading=maker("first"),Reflux.joinStrict=maker("strict"),Reflux.joinConcat=maker("all");var _=Reflux.utils=require("./utils");Reflux.EventEmitter=_.EventEmitter,Reflux.Promise=_.Promise,Reflux.createActions=function(){var e=function(e,t){Object.keys(e).forEach(function(r){var i=e[r];t[r]=Reflux.createAction(i)})};return function(t){var r={};return t instanceof Array?t.forEach(function(t){_.isObject(t)?e(t,r):r[t]=Reflux.createAction(t)}):e(t,r),r}}(),Reflux.setEventEmitter=function(e){Reflux.EventEmitter=_.EventEmitter=e},Reflux.setPromise=function(e){Reflux.Promise=_.Promise=e},Reflux.setPromiseFactory=function(e){_.createPromise=e},Reflux.nextTick=function(e){_.nextTick=e},Reflux.use=function(e){e(Reflux)},Reflux.__keep=require("./Keep"),Function.prototype.bind||console.error("Function.prototype.bind not available. ES5 shim required. https://github.com/spoike/refluxjs#es5"),exports["default"]=Reflux,module.exports=exports["default"];

},{"./ActionMethods":16,"./Keep":17,"./ListenerMethods":18,"./PublisherMethods":19,"./StoreMethods":20,"./createAction":22,"./createStore":23,"./joins":25,"./utils":27}],25:[function(require,module,exports){
"use strict";function makeStopper(t,e,r){return function(){var s,i=r.subscriptions,n=i?i.indexOf(t):-1;for(_.throwIf(-1===n,"Tried to remove join already gone from subscriptions list!"),s=0;s<e.length;s++)e[s]();i.splice(n,1)}}function reset(t){t.listenablesEmitted=new Array(t.numberOfListenables),t.args=new Array(t.numberOfListenables)}function newListener(t,e){return function(){var r=slice.call(arguments);if(e.listenablesEmitted[t])switch(e.strategy){case"strict":throw new Error("Strict join failed because listener triggered twice.");case"last":e.args[t]=r;break;case"all":e.args[t].push(r)}else e.listenablesEmitted[t]=!0,e.args[t]="all"===e.strategy?[r]:r;emitIfAllListenablesEmitted(e)}}function emitIfAllListenablesEmitted(t){for(var e=0;e<t.numberOfListenables;e++)if(!t.listenablesEmitted[e])return;t.callback.apply(t.listener,t.args),reset(t)}var createStore=require("./createStore"),_=require("./utils"),slice=Array.prototype.slice,strategyMethodNames={strict:"joinStrict",first:"joinLeading",last:"joinTrailing",all:"joinConcat"};exports.staticJoinCreator=function(t){return function(){var e=slice.call(arguments);return createStore({init:function(){this[strategyMethodNames[t]].apply(this,e.concat("triggerAsync"))}})}},exports.instanceJoinCreator=function(t){return function(){_.throwIf(arguments.length<2,"Cannot create a join with less than 2 listenables!");var e,r,s=slice.call(arguments),i=s.pop(),n=s.length,a={numberOfListenables:n,callback:this[i]||i,listener:this,strategy:t},l=[];for(e=0;n>e;e++)_.throwIf(this.validateListening(s[e]));for(e=0;n>e;e++)l.push(s[e].listen(newListener(e,a),this));return reset(a),r={listenable:s},r.stop=makeStopper(r,l,this),this.subscriptions=(this.subscriptions||[]).concat(r),r}};

},{"./createStore":23,"./utils":27}],26:[function(require,module,exports){
"use strict";var _=require("./utils");module.exports=function(t){var n={init:[],preEmit:[],shouldEmit:[]},i=function r(t){var i={};return t.mixins&&t.mixins.forEach(function(t){_.extend(i,r(t))}),_.extend(i,t),Object.keys(n).forEach(function(i){t.hasOwnProperty(i)&&n[i].push(t[i])}),i}(t);return n.init.length>1&&(i.init=function(){var t=arguments;n.init.forEach(function(n){n.apply(this,t)},this)}),n.preEmit.length>1&&(i.preEmit=function(){return n.preEmit.reduce(function(t,n){var i=n.apply(this,t);return void 0===i?t:[i]}.bind(this),arguments)}),n.shouldEmit.length>1&&(i.shouldEmit=function(){var t=arguments;return!n.shouldEmit.some(function(n){return!n.apply(this,t)},this)}),Object.keys(n).forEach(function(t){1===n[t].length&&(i[t]=n[t][0])}),i};

},{"./utils":27}],27:[function(require,module,exports){
"use strict";function capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}function callbackName(e,t){return t=t||"on",t+exports.capitalize(e)}function checkEnv(target){var flag=void 0;try{eval(target)&&(flag=!0)}catch(e){flag=!1}environment[callbackName(target,"has")]=flag}function isObject(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function extend(e){if(!isObject(e))return e;for(var t,r,n=1,o=arguments.length;o>n;n++){t=arguments[n];for(r in t)if(Object.getOwnPropertyDescriptor&&Object.defineProperty){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,i)}else e[r]=t[r]}return e}function isFunction(e){return"function"==typeof e}function object(e,t){for(var r={},n=0;n<e.length;n++)r[e[n]]=t[n];return r}function isArguments(e){return"object"==typeof e&&"callee"in e&&"number"==typeof e.length}function throwIf(e,t){if(e)throw Error(t||e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.capitalize=capitalize,exports.callbackName=callbackName,exports.isObject=isObject,exports.extend=extend,exports.isFunction=isFunction,exports.object=object,exports.isArguments=isArguments,exports.throwIf=throwIf;var environment={};exports.environment=environment,checkEnv("setImmediate"),checkEnv("Promise"),exports.EventEmitter=require("eventemitter3"),environment.hasSetImmediate?exports.nextTick=function(e){setImmediate(e)}:exports.nextTick=function(e){setTimeout(e,0)},environment.hasPromise?(exports.Promise=Promise,exports.createPromise=function(e){return new exports.Promise(e)}):(exports.Promise=null,exports.createPromise=function(){});

},{"eventemitter3":15}],28:[function(require,module,exports){
var _=require("reflux-core/lib/utils"),ListenerMethods=require("reflux-core/lib/ListenerMethods");module.exports=_.extend({componentWillUnmount:ListenerMethods.stopListeningToAll},ListenerMethods);

},{"reflux-core/lib/ListenerMethods":18,"reflux-core/lib/utils":27}],29:[function(require,module,exports){
var ListenerMethods=require("reflux-core/lib/ListenerMethods"),ListenerMixin=require("./ListenerMixin"),_=require("reflux-core/lib/utils");module.exports=function(t,e){return{getInitialState:function(){return _.isFunction(t.getInitialState)?void 0===e?t.getInitialState():_.object([e],[t.getInitialState()]):{}},componentDidMount:function(){_.extend(this,ListenerMethods);var i=this,n=void 0===e?this.setState:function(t){("undefined"==typeof i.isMounted||i.isMounted()===!0)&&i.setState(_.object([e],[t]))};this.listenTo(t,n)},componentWillUnmount:ListenerMixin.componentWillUnmount}};

},{"./ListenerMixin":28,"reflux-core/lib/ListenerMethods":18,"reflux-core/lib/utils":27}],30:[function(require,module,exports){
var ListenerMethods=require("reflux-core/lib/ListenerMethods"),ListenerMixin=require("./ListenerMixin"),_=require("reflux-core/lib/utils");module.exports=function(t,e,i){return i=_.isFunction(e)?e:i,{getInitialState:function(){if(_.isFunction(t.getInitialState)){if(_.isFunction(e))return i.call(this,t.getInitialState());var n=i.call(this,t.getInitialState());return"undefined"!=typeof n?_.object([e],[n]):{}}return{}},componentDidMount:function(){_.extend(this,ListenerMethods);var n=this,r=function(t){if(_.isFunction(e))n.setState(i.call(n,t));else{var r=i.call(n,t);n.setState(_.object([e],[r]))}};this.listenTo(t,r)},componentWillUnmount:ListenerMixin.componentWillUnmount}};

},{"./ListenerMixin":28,"reflux-core/lib/ListenerMethods":18,"reflux-core/lib/utils":27}],31:[function(require,module,exports){
var Reflux=require("reflux-core");Reflux.connect=require("./connect"),Reflux.connectFilter=require("./connectFilter"),Reflux.ListenerMixin=require("./ListenerMixin"),Reflux.listenTo=require("./listenTo"),Reflux.listenToMany=require("./listenToMany"),module.exports=Reflux;

},{"./ListenerMixin":28,"./connect":29,"./connectFilter":30,"./listenTo":32,"./listenToMany":33,"reflux-core":24}],32:[function(require,module,exports){
var ListenerMethods=require("reflux-core/lib/ListenerMethods");module.exports=function(e,t,n){return{componentDidMount:function(){for(var o in ListenerMethods)if(this[o]!==ListenerMethods[o]){if(this[o])throw"Can't have other property '"+o+"' when using Reflux.listenTo!";this[o]=ListenerMethods[o]}this.listenTo(e,t,n)},componentWillUnmount:ListenerMethods.stopListeningToAll}};

},{"reflux-core/lib/ListenerMethods":18}],33:[function(require,module,exports){
var ListenerMethods=require("reflux-core/lib/ListenerMethods");module.exports=function(e){return{componentDidMount:function(){for(var t in ListenerMethods)if(this[t]!==ListenerMethods[t]){if(this[t])throw"Can't have other property '"+t+"' when using Reflux.listenToMany!";this[t]=ListenerMethods[t]}this.listenToMany(e)},componentWillUnmount:ListenerMethods.stopListeningToAll}};

},{"reflux-core/lib/ListenerMethods":18}]},{},[4]);
