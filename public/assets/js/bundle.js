(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var React=require("react"),Router=require("react-router"),Route=Router.Route,PaymentWrapper=require("./components/paymentwrapper.jsx"),routes=React.createElement(Route,{handler:PaymentWrapper},React.createElement(Route,{name:"bill",path:"/:bid",handler:PaymentWrapper}));Router.run(routes,function(e){React.render(React.createElement(e,null),document.getElementById("wrapper"))});

},{"./components/paymentwrapper.jsx":4,"react":"react","react-router":"react-router"}],2:[function(require,module,exports){
var React=require("react"),ReactIntl=require("react-intl"),IntlMixin=ReactIntl.IntlMixin,FormattedNumber=ReactIntl.FormattedNumber;module.exports=React.createClass({displayName:"exports",mixins:[IntlMixin],render:function(){return React.createElement("div",{className:"paymentList__transaction clearfix col-md-12"},React.createElement("div",{className:"col-xs-3 col-md-4 transaction__amount"},React.createElement(FormattedNumber,{value:this.props.amount,style:"currency",currency:"EUR"})),React.createElement("div",{className:"col-xs-9 col-md-8"},React.createElement("i",{className:"fa fa-long-arrow-right"})," ",this.props.to))}});

},{"react":"react","react-intl":"react-intl"}],3:[function(require,module,exports){
var React=require("react"),Payment=require("./payment.jsx"),ReactIntl=require("react-intl"),IntlMixin=ReactIntl.IntlMixin,FormattedNumber=ReactIntl.FormattedNumber,_map=require("lodash.map");module.exports=React.createClass({displayName:"exports",mixins:[IntlMixin],render:function(){var e=_map(this.props.payments,function(e,t){var a=e.to.map(function(e,t){return React.createElement(Payment,{key:t,to:e.to,amount:e.amount})});return React.createElement("div",{key:t,className:"paymentList__payment clearfix"},React.createElement("div",{className:"paymentList__from"},e.name),React.createElement("div",{className:"paymentList__transactions clearfix bg-primary"},a))});return React.createElement("div",{id:"paymentList",className:"col-md-4"},React.createElement("div",{className:"stats"},React.createElement("b",null,"Total: ")," ",React.createElement(FormattedNumber,{value:this.props.total,style:"currency",currency:this.props.currency})," ",React.createElement("br",null),React.createElement("b",null,"Share: ")," ",React.createElement(FormattedNumber,{value:this.props.share,style:"currency",currency:this.props.currency})," ",React.createElement("br",null)),e)}});

},{"./payment.jsx":2,"lodash.map":"lodash.map","react":"react","react-intl":"react-intl"}],4:[function(require,module,exports){
var React=require("react"),PersonList=require("./personlist.jsx"),PaymentList=require("./paymentlist.jsx"),Settings=require("./settings.jsx"),Router=require("react-router"),request=require("browser-request"),shareBill=require("../functions.js");module.exports=React.createClass({displayName:"exports",contextTypes:{router:React.PropTypes.func},getInitialState:function(){return{payments:{},total:0,share:0,currency:"EUR",showSettings:!1,bid:this.context.router.getCurrentParams().bid||!1}},changeCurrency:function(t){this.setState({currency:t})},toggleSettings:function(){this.setState({showSettings:!this.state.showSettings})},shareTotal:function(t){for(var e,r,s=[],i=0,n=t.length;n>i;i++)e=t[i],r="string"==typeof e.paid?e.paid.split(" ").reduce(function(t,e){return Number(t)+Number(e.replace(",","."))},0):e.paid,s.push({name:e.name,paid:Number(r)});var a=shareBill(s),c=window.location.origin,o=this.context.router,u=this.state.bid?"PUT":"POST",h=this.state.bid?"/bill/"+this.state.bid:"/bill",l=this.state.bid;request({url:c+"/api/v1"+h,method:u,body:{data:t,currency:this.state.currency},json:!0},function(t,e,r){this.state.bid||(l=JSON.parse(r).bid,o.transitionTo("bill",{bid:l})),this.setState({payments:a.payments,total:a.total,share:a.share,bid:l})}.bind(this))},render:function(){this.context.router;return React.createElement("div",null,React.createElement(Settings,{onCurrencyChange:this.changeCurrency,currency:this.state.currency,showSettings:this.state.showSettings}),React.createElement(PersonList,{onShareTotal:this.shareTotal,onCurrencyChange:this.changeCurrency,currency:this.state.currency,onToggleSettings:this.toggleSettings,bid:this.state.bid}),React.createElement(PaymentList,{payments:this.state.payments,total:this.state.total,share:this.state.share,currency:this.state.currency}))}});

},{"../functions.js":8,"./paymentlist.jsx":3,"./personlist.jsx":6,"./settings.jsx":7,"browser-request":"browser-request","react":"react","react-router":"react-router"}],5:[function(require,module,exports){
var React=require("react");module.exports=React.createClass({displayName:"exports",handleChange:function(e,a){this.props.onPersonChange(e,a.target.value,this.props.idx)},render:function(){var e=1===this.props.personCount?"hidden":"col-xs-1",a=this.props.bid?this.props.name:void 0,t=this.props.bid?this.props.paid:void 0;return React.createElement("div",{className:"personList__person clearfix"},React.createElement("div",{className:"person__name col-xs-4"},React.createElement("input",{type:"text",className:"form-control input-lg",placeholder:this.props.name,value:a,onChange:this.handleChange.bind(this,"name"),autoFocus:!0})),React.createElement("div",{className:"person__paid col-xs-6"},React.createElement("div",{className:"input-group"},React.createElement("input",{type:"tel",className:"form-control input-lg",placeholder:this.props.paid,value:t,onChange:this.handleChange.bind(this,"paid")}),React.createElement("div",{className:"input-group-addon"},this.props.currency))),React.createElement("div",{className:e},React.createElement("div",{className:"btn btn-primary btn-sm btn-remove",onClick:this.props.onDelete,tabIndex:"-1"},React.createElement("i",{className:"fa fa-minus"}))))}});

},{"react":"react"}],6:[function(require,module,exports){
var React=require("react/addons"),Person=require("./person.jsx"),request=require("browser-request");module.exports=React.createClass({displayName:"exports",componentDidMount:function(){var e=window.location.origin;this.props.bid&&request(e+"/api/v1/bill/"+this.props.bid,function(e,t,s){var n=JSON.parse(s);this.setState({persons:n.data}),this.props.onCurrencyChange(n.currency)}.bind(this))},getInitialState:function(){var e=this.props.bid?[]:[{name:"John Doe",paid:"0"}],t=this.props.bid?this.props.currency:"EUR";return{persons:e,currency:t}},removePerson:function(e){1!==this.state.persons.length&&this.setState({persons:React.addons.update(this.state.persons,{$splice:[[e,1]]})})},handleChange:function(e,t,s){var n=this.state.persons.slice();n[s][e]=t,this.setState({persons:n})},addPerson:function(e){e.preventDefault(),this.setState({persons:this.state.persons.concat([{name:"John Doe",paid:0}])})},shareTotal:function(e){e.preventDefault(),this.props.onShareTotal(this.state.persons)},toggleSettings:function(e){e.preventDefault(),this.props.onToggleSettings()},render:function(){var e=this.state.persons.map(function(e,t){return React.createElement(Person,{key:t,idx:t,name:e.name,paid:e.paid,personCount:this.state.persons.length,onPersonChange:this.handleChange,onDelete:this.removePerson.bind(this,t),currency:this.props.currency,bid:this.props.bid})}.bind(this));return React.createElement("form",{id:"personList",className:"col-md-8"},e,React.createElement("div",{id:"help",className:"col-xs-12"},"Protip: you can enter multiple amounts for person by separating them by space!"),React.createElement("div",{id:"buttons",className:"col-xs-12"},React.createElement("button",{className:"btn btn-lg btn-primary",onClick:this.addPerson},React.createElement("i",{className:"fa fa-user-plus"}),React.createElement("span",{className:"hidden-xs"}," Add person")),React.createElement("button",{className:"btn btn-lg btn-primary settings",onClick:this.toggleSettings},React.createElement("i",{className:"fa fa-cog"}),React.createElement("span",{className:"hidden-xs"}," Settings")),React.createElement("button",{className:"btn btn-lg btn-primary",onClick:this.shareTotal},React.createElement("i",{className:"fa fa-calculator"}),React.createElement("span",{className:"hidden-xs"}," Share total"))))}});

},{"./person.jsx":5,"browser-request":"browser-request","react/addons":"react/addons"}],7:[function(require,module,exports){
var React=require("react");module.exports=React.createClass({displayName:"exports",handleCurrencyChange:function(e){this.props.onCurrencyChange(e.target.value)},render:function(){var e=this.props.showSettings?"form-horizontal col-xs-12":"hidden";return React.createElement("form",{id:"settings",className:e},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"currency"},"Currency"),React.createElement("select",{id:"currency",className:"form-control input-lg",value:this.props.currency,onChange:this.handleCurrencyChange},React.createElement("option",{value:"EUR"},"EUR"),React.createElement("option",{value:"USD"},"USD"))))}});

},{"react":"react"}],8:[function(require,module,exports){
var _sortBy=require("lodash.sortby"),_each=require("lodash.foreach"),_reduce=require("lodash.reduce"),_find=require("lodash.find"),_remove=require("lodash.remove"),round=function(e){return+(Math.round(e+"e+2")+"e-2")};module.exports=function(e){var r,t,n,a;return _remove(e,function(e){return!e.name||0===e.name.length}),r=_sortBy(e,"paid").reverse(),_each(r,function(e,r){e.id=r,e.paid=Math.round(Number(100*e.paid))}),t=_reduce(r,function(e,r){return e+r.paid},0),n=r.length>0?Math.round(Number(t/r.length)):0,a={},_each(r,function(e){e.left=Math.round(n-e.paid);for(var t;e.left>0;)if(a[e.id]=a[e.id]||{name:e.name,to:[]},t=_find(r,function(e){return e.left<0})){var u=Math.abs(t.left)>e.left?e.left:Math.abs(t.left);t.left+=u,e.left-=u,a[e.id].to.push({to:t.name,amount:Number(u/100)})}else e.left=0}),{payments:a,total:Number(t/100),share:Number(n/100)}};

},{"lodash.find":"lodash.find","lodash.foreach":"lodash.foreach","lodash.reduce":"lodash.reduce","lodash.remove":"lodash.remove","lodash.sortby":"lodash.sortby"}]},{},[1]);
